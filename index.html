<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hepta-SVT - Ù…Ù†ØµØ© Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­ÙŠØ§Ø© ÙˆØ§Ù„Ø£Ø±Ø¶</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    <style>
:root {
    --primary: #6366f1;
    --secondary: #06b6d4;
    --accent: #f59e0b;
    --success: #10b981;
    --danger: #ef4444;
    --dark: #0f172a;
    --white: #ffffff;
    --gray: #64748b;
    --gradient-main: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: 'Cairo', sans-serif;
    background: var(--dark);
    color: var(--white);
    line-height: 1.6;
    min-height: 100vh;
}

.bg-animation {
    position: fixed;
    inset: 0;
    z-index: 0;
    opacity: 0.15;
    pointer-events: none;
}

.bg-animation::before, .bg-animation::after {
    content: '';
    position: absolute;
    border-radius: 50%;
    filter: blur(100px);
    animation: float 20s infinite ease-in-out;
}

.bg-animation::before {
    width: 600px;
    height: 600px;
    background: var(--primary);
    top: -200px;
    right: -200px;
}

.bg-animation::after {
    width: 500px;
    height: 500px;
    background: var(--secondary);
    bottom: -150px;
    left: -150px;
    animation-delay: 5s;
}

@keyframes float {
    0%, 100% { transform: translate(0, 0); }
    25% { transform: translate(50px, -50px); }
    50% { transform: translate(-30px, 30px); }
    75% { transform: translate(40px, 40px); }
}

/* Remove default margins from headings */
.page > h2 {
    margin-top: 0;
}

.page {
    padding-top: 0 !important;
    margin-top: 0 !important;
}

.page > *:first-child {
    margin-top: 0 !important;
    padding-top: 0 !important;
}

.navbar {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 60px;
    background: rgba(15, 23, 42, 0.9);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    z-index: 1000;
}

.menu-btn {
    width: 45px;
    height: 45px;
    background: var(--gradient-main);
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-size: 24px;
    color: var(--white);
}

.logo-text {
    font-size: 22px;
    font-weight: 700;
    background: var(--gradient-main);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.sidebar {
    position: fixed;
    top: 0;
    right: -320px;
    width: 320px;
    height: 100vh;
    background: rgba(15, 23, 42, 0.95);
    backdrop-filter: blur(30px);
    padding: 90px 20px 20px;
    transition: 0.3s;
    z-index: 999;
    overflow-y: auto;
}

.sidebar.active { right: 0; }

.sidebar-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    opacity: 0;
    visibility: hidden;
    transition: 0.3s;
    z-index: 998;
}

.sidebar-overlay.active {
    opacity: 1;
    visibility: visible;
}

.sidebar-item {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 10px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 15px;
    transition: 0.3s;
}

.sidebar-item:hover, .sidebar-item.active {
    background: var(--gradient-main);
}

.main {
    margin-top: 60px;
    padding: 5px 20px 30px 20px;
    position: relative;
    z-index: 1;
    min-height: calc(100vh - 60px);
}

.page {
    display: none;
    animation: fadeInUp 0.5s;
}

.page.active { display: block; }

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

.hero {
    background: var(--gradient-main);
    border-radius: 16px;
    padding: 20px 40px 50px 40px;
    text-align: center;
    margin-bottom: 40px;
    margin-top: 0;
}

.hero-title {
    font-size: 42px;
    font-weight: 800;
    margin-bottom: 15px;
}

.cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
    margin-bottom: 30px;
}

.card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    padding: 30px;
    cursor: pointer;
    transition: 0.3s;
    display: flex;
    flex-direction: column;
    min-height: 280px;
}

.card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
}

.card-icon {
    width: 60px;
    height: 60px;
    background: var(--gradient-main);
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    margin-bottom: 20px;
}

.card-title {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 10px;
}

.card-description {
    font-size: 14px;
    color: var(--gray);
}

.back-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 10px 20px;
    border-radius: 10px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: var(--white);
    margin-bottom: 20px;
    transition: 0.3s;
}

.back-btn:hover {
    background: rgba(255, 255, 255, 0.15);
}

.btn {
    padding: 14px 30px;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    border: none;
    transition: 0.3s;
    font-family: 'Cairo', sans-serif;
}

.btn-primary {
    background: var(--gradient-main);
    color: var(--white);
    box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
}

.btn-ghost {
    background: transparent;
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: var(--gray);
}

.btn-ghost:hover {
    border-color: var(--primary);
    color: var(--primary);
}

.btn-warning {
    background: linear-gradient(135deg, #f59e0b, #f97316);
    color: var(--white);
}

.btn-danger {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: var(--white);
}

/* Game HUD */
.game-hud {
    position: fixed;
    top: 70px;
    left: 0;
    right: 0;
    background: rgba(15, 23, 42, 0.95);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding: 12px 20px;
    z-index: 999;
    display: none;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.game-hud.active {
    display: grid;
}

.hud-item {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    padding: 10px;
    text-align: center;
}

.hud-label {
    font-size: 10px;
    color: var(--gray);
    text-transform: uppercase;
    margin-bottom: 3px;
}

.hud-value {
    font-family: 'Orbitron', sans-serif;
    font-size: 20px;
    font-weight: 700;
    color: var(--primary);
}

.hud-value.points { color: var(--accent); }
.hud-value.timer { color: var(--success); }

/* Levels Grid */
.levels-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 20px;
    max-width: 900px;
    margin: 0 auto;
}

.level-card {
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    padding: 30px 20px;
    text-align: center;
    cursor: pointer;
    transition: 0.3s;
    position: relative;
}

.level-card:not(.locked):hover {
    transform: translateY(-5px);
    border-color: var(--primary);
    box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
}

.level-card.locked {
    opacity: 0.4;
    cursor: not-allowed;
}

.level-number {
    font-size: 48px;
    font-weight: 900;
    font-family: 'Orbitron', sans-serif;
    background: var(--gradient-main);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 10px;
}

.level-label {
    font-size: 14px;
    color: var(--gray);
}

.level-stars {
    margin-top: 10px;
    font-size: 20px;
}

.level-lock {
    position: absolute;
    top: 15px;
    left: 15px;
    font-size: 24px;
}

/* Game Content */
.game-content {
    margin-top: 100px;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
}

.question-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    padding: 30px;
}

.clue-box {
    background: rgba(6, 182, 212, 0.1);
    border: 1px solid rgba(6, 182, 212, 0.2);
    border-radius: 12px;
    padding: 25px;
    margin-bottom: 30px;
    text-align: center;
}

.clue-label {
    font-size: 12px;
    color: var(--secondary);
    text-transform: uppercase;
    margin-bottom: 10px;
    font-weight: 700;
}

.clue-text {
    font-size: 22px;
    font-weight: 700;
}

.answer-section {
    margin-bottom: 25px;
}

.answer-label {
    font-size: 13px;
    color: var(--gray);
    margin-bottom: 15px;
    text-align: center;
}

.answer-slots {
    display: flex;
    gap: 6px;
    justify-content: center;
    flex-wrap: nowrap;
    min-height: 65px;
    background: rgba(0, 0, 0, 0.2);
    border: 2px dashed rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 12px 10px;
    direction: ltr;
    overflow-x: auto;
}

.answer-slots.correct {
    border-color: var(--success);
    background: rgba(16, 185, 129, 0.1);
}

.answer-slots.wrong {
    border-color: var(--danger);
    animation: shake 0.5s;
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
}

.empty-slot {
    min-width: 45px;
    width: 45px;
    height: 52px;
    background: rgba(99, 102, 241, 0.1);
    border: 2px solid rgba(99, 102, 241, 0.3);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 26px;
    font-weight: 900;
    font-family: 'Orbitron', sans-serif;
    color: var(--primary);
    flex-shrink: 0;
    animation: popIn 0.3s;
}

.empty-slot.filled {
    background: rgba(99, 102, 241, 0.2);
    border-color: var(--primary);
    cursor: pointer;
}

.empty-slot.filled:hover {
    transform: scale(1.1);
}

.empty-slot.hint {
    background: rgba(16, 185, 129, 0.2);
    border-color: var(--success);
    color: var(--success);
}

@keyframes popIn {
    from { transform: scale(0); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

.choices-section {
    margin-bottom: 20px;
}

.choices-label {
    font-size: 13px;
    color: var(--gray);
    margin-bottom: 15px;
    text-align: center;
}

.letter-choices {
    display: flex;
    gap: 8px;
    justify-content: center;
    flex-wrap: wrap;
    padding: 20px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 12px;
    direction: ltr;
}

.letter-btn {
    width: 52px;
    height: 56px;
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(99, 102, 241, 0.1));
    border: 2px solid rgba(99, 102, 241, 0.4);
    border-radius: 12px;
    color: var(--white);
    font-size: 24px;
    font-weight: 900;
    font-family: 'Orbitron', sans-serif;
    cursor: pointer;
    transition: 0.2s;
}

.letter-btn:hover:not(:disabled) {
    transform: translateY(-4px) scale(1.05);
    border-color: var(--primary);
}

.letter-btn:disabled {
    opacity: 0.2;
    cursor: not-allowed;
}

.game-actions {
    display: flex;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
}

/* Feedback */
.feedback-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(10px);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 3000;
}

.feedback-overlay.active { display: flex; }

.feedback-card {
    background: linear-gradient(135deg, rgba(15, 23, 42, 0.95), rgba(30, 41, 59, 0.95));
    border: 2px solid rgba(99, 102, 241, 0.3);
    border-radius: 24px;
    padding: 40px;
    text-align: center;
    animation: bounceIn 0.5s;
    max-width: 90%;
}

@keyframes bounceIn {
    0% { transform: scale(0.5); opacity: 0; }
    70% { transform: scale(1.05); }
    100% { transform: scale(1); opacity: 1; }
}

.feedback-icon {
    font-size: 70px;
    margin-bottom: 15px;
}

.feedback-title {
    font-size: 28px;
    font-weight: 900;
    margin-bottom: 10px;
}

.feedback-title.success { color: var(--success); }

.feedback-msg {
    font-size: 15px;
    color: var(--gray);
    margin-bottom: 15px;
}

.feedback-points {
    background: rgba(245, 158, 11, 0.15);
    border: 1px solid rgba(245, 158, 11, 0.3);
    border-radius: 12px;
    padding: 10px 18px;
    font-size: 16px;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 20px;
    display: inline-block;
}

/* Level Complete */
.level-complete {
    max-width: 600px;
}

.level-complete-title {
    font-size: 36px;
    font-weight: 900;
    margin-bottom: 20px;
    background: var(--gradient-main);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.level-stats {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 25px;
}

.stat-row {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.stat-row:last-child {
    border-bottom: none;
}

.stat-label {
    color: var(--gray);
}

.stat-value {
    font-weight: 700;
    font-family: 'Orbitron', sans-serif;
    color: var(--accent);
}

/* Leaderboard */
.leaderboard {
    max-width: 700px;
    margin: 0 auto;
}

.leaderboard-title {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 25px;
    text-align: center;
}

.leaderboard-table {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
}

.leaderboard-row {
    display: grid;
    grid-template-columns: 70px 1fr 110px 100px;
    gap: 15px;
    padding: 18px 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    align-items: center;
    transition: 0.3s;
}

.leaderboard-row:hover:not(.header) {
    background: rgba(255, 255, 255, 0.03);
}

.leaderboard-row:last-child {
    border-bottom: none;
}

.leaderboard-row.header {
    background: rgba(99, 102, 241, 0.15);
    font-weight: 700;
    font-size: 13px;
    color: var(--gray);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.leaderboard-rank {
    font-size: 28px;
    font-weight: 900;
    font-family: 'Orbitron', sans-serif;
    background: var(--gradient-main);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-align: center;
}

.leaderboard-name {
    font-weight: 600;
    font-size: 16px;
}

.leaderboard-score {
    font-family: 'Orbitron', sans-serif;
    color: var(--success);
    font-weight: 700;
    font-size: 18px;
    text-align: center;
}

.leaderboard-time {
    font-family: 'Orbitron', sans-serif;
    font-size: 15px;
    color: var(--accent);
    font-weight: 600;
    text-align: center;
}

/* Popup */
.popup {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.9);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 3000;
    padding: 20px;
}

.popup.active { display: flex; }

.popup-content {
    position: relative;
    max-width: 90%;
    max-height: 85vh;
}

.popup-img {
    max-width: 100%;
    max-height: 85vh;
    border-radius: 16px;
}

.popup-close {
    position: absolute;
    top: -50px;
    left: -50px;
    width: 50px;
    height: 50px;
    background: var(--white);
    color: var(--dark);
    border: none;
    border-radius: 50%;
    font-size: 24px;
    cursor: pointer;
}

/* Responsive */
@media (max-width: 768px) {
    .hero-title { font-size: 32px; }
    .cards-grid { grid-template-columns: 1fr; }
    .game-hud { grid-template-columns: repeat(2, 1fr); gap: 8px; padding: 10px; }
    .hud-value { font-size: 18px; }
    .empty-slot { min-width: 38px; width: 38px; height: 46px; font-size: 22px; }
    .letter-btn { width: 46px; height: 50px; font-size: 20px; }
    .answer-slots { gap: 4px; }
    .question-card { padding: 20px; }
    .leaderboard-row { grid-template-columns: 50px 1fr 90px 80px; gap: 10px; padding: 12px 15px; }
    .feedback-card { padding: 30px 25px; }
}

@media (max-width: 480px) {
    .empty-slot { min-width: 32px; width: 32px; height: 40px; font-size: 18px; }
    .answer-slots { gap: 3px; padding: 10px 5px; }
}
</style>
</head>
<body>
<div class="bg-animation"></div>

<!-- Navbar -->
<nav class="navbar">
    <button class="menu-btn" onclick="toggleSidebar()">â˜°</button>
    <h1 class="logo-text">Hepta-SVT</h1>
    <div id="userNameDisplay" style="display:none;font-size:13px;font-weight:600;background:rgba(255,255,255,0.08);padding:6px 12px;border-radius:8px;">
        ğŸ‘¤ <span id="userNameText"></span>
    </div>
</nav>

<!-- Sidebar -->
<div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>
<aside class="sidebar" id="sidebar">
    <div class="sidebar-item active" onclick="navigateTo('dashboard')">
        <span>ğŸ </span>
        <span>Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
    </div>
    <div class="sidebar-item" onclick="navigateTo('lessons')">
        <span>ğŸ“š</span>
        <span>Ø§Ù„Ø¯Ø±ÙˆØ³</span>
    </div>
    <div class="sidebar-item" onclick="navigateTo('tests')">
        <span>âœï¸</span>
        <span>Ø§Ø®ØªØ¨Ø± Ù†ÙØ³Ùƒ</span>
    </div>
    <div class="sidebar-item" onclick="navigateTo('laboratory')">
        <span>ğŸ§ª</span>
        <span>Ø§Ù„Ù…Ø®ØªØ¨Ø±</span>
    </div>
    <div class="sidebar-item" onclick="navigateTo('exercises')">
        <span>ğŸ“</span>
        <span>Ø³Ù„Ø§Ø³Ù„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</span>
    </div>
    <div class="sidebar-item" onclick="navigateTo('videos')">
        <span>ğŸ¥</span>
        <span>ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ØªØ¹Ù„ÙŠÙ…ÙŠØ©</span>
    </div>
</aside>

<!-- HUD -->
<div class="game-hud" id="gameHud">
    <div class="hud-item">
        <div class="hud-label">Ø§Ù„Ù…Ø³ØªÙˆÙ‰</div>
        <div class="hud-value" id="hudLevel">1</div>
    </div>
    <div class="hud-item">
        <div class="hud-label">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</div>
        <div class="hud-value" id="hudQuestion">1/10</div>
    </div>
    <div class="hud-item">
        <div class="hud-label">Ø§Ù„Ù†Ù‚Ø§Ø·</div>
        <div class="hud-value points" id="hudPoints">0</div>
    </div>
    <div class="hud-item">
        <div class="hud-label">Ø§Ù„ÙˆÙ‚Øª</div>
        <div class="hud-value timer" id="hudTimer">00:00</div>
    </div>
</div>

<!-- Main -->
<main class="main">

<!-- Name Input Screen -->
<section id="nameScreen" class="page active">
    <div style="max-width:500px;margin:80px auto;text-align:center;">
        <div style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:50px 40px;">
            <div style="font-size:70px;margin-bottom:15px;">ğŸ‘‹</div>
            <h2 style="font-size:32px;font-weight:800;margin-bottom:10px;">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ!</h2>
            <p style="color:var(--gray);margin-bottom:30px;">Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø¨Ø¯Ø¡</p>
            
            <input type="text" id="firstName" placeholder="Ø§Ù„Ø§Ø³Ù…..." maxlength="20" 
                   style="width:100%;padding:15px 20px;background:rgba(255,255,255,0.05);border:2px solid rgba(255,255,255,0.1);border-radius:12px;color:var(--white);font-size:18px;font-family:'Cairo',sans-serif;margin-bottom:15px;text-align:center;"
                   onkeyup="checkNameInput()">
            
            <input type="text" id="lastName" placeholder="Ø§Ù„Ù†Ø³Ø¨..." maxlength="20"
                   style="width:100%;padding:15px 20px;background:rgba(255,255,255,0.05);border:2px solid rgba(255,255,255,0.1);border-radius:12px;color:var(--white);font-size:18px;font-family:'Cairo',sans-serif;margin-bottom:15px;text-align:center;"
                   onkeyup="checkNameInput()" onkeypress="if(event.key==='Enter') submitName()">
            
            <div id="nameError" style="display:none;background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.3);border-radius:12px;padding:15px;margin-bottom:20px;font-size:14px;color:var(--danger);">
                âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„! Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ø³Ù… Ø¢Ø®Ø±
            </div>
            
            <button class="btn btn-primary" id="startBtn" onclick="submitName()" disabled>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†ØµØ© ğŸš€</button>
        </div>
    </div>
</section>

<!-- Dashboard -->
<section id="dashboard" class="page">
    <div class="hero" style="margin-bottom:30px;">
        <h2 class="hero-title" style="font-size:36px;margin-bottom:5px;">Ù…Ø±Ø­Ø¨Ø§Ù‹ <span id="dashboardName">Ø¨Ùƒ</span>! ğŸ‘‹</h2>
        <p style="font-size:18px;margin:0;">Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø£Ù† ØªÙØ¹Ù„ Ø§Ù„ÙŠÙˆÙ…ØŸ</p>
    </div>
    
    <!-- Carousel Container -->
    <div style="position:relative;max-width:600px;margin:0 auto;">
        
        <!-- Dashboard Cards Carousel -->
        <div style="position:relative;min-height:450px;">
            
            <!-- Card 1: Ø§Ù„Ø¯Ø±ÙˆØ³ -->
            <div class="carousel-slide" style="position:absolute;width:100%;opacity:1;transition:opacity 0.5s ease;padding:40px;background:linear-gradient(135deg,rgba(59,130,246,0.15),rgba(37,99,235,0.05));border:2px solid rgba(59,130,246,0.3);border-radius:16px;text-align:center;">
                <div style="width:80px;height:80px;background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:40px;margin:0 auto 25px;">ğŸ“š</div>
                <h3 style="font-size:28px;font-weight:800;margin-bottom:15px;color:white;">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ø±ÙˆØ³</h3>
                <p style="font-size:16px;line-height:1.8;color:rgba(255,255,255,0.8);margin-bottom:25px;">
                    Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ø±ÙˆØ³ØŸ<br>
                    Ø´Ø§Ù‡Ø¯ Ø§Ù„Ù…Ù„Ø®ØµØ§Øª ÙˆØ§Ù„Ø´Ø±ÙˆØ­Ø§Øª Ø§Ù„Ù…ÙØµÙ„Ø©
                </p>
                <div style="display:flex;align-items:center;justify-content:space-between;padding:20px;background:rgba(0,0,0,0.2);border-radius:12px;margin-bottom:20px;">
                    <span style="font-size:15px;color:rgba(255,255,255,0.7);">6 Ø¯Ø±ÙˆØ³ Ù…ØªØ§Ø­Ø©</span>
                    <span style="color:#3b82f6;font-weight:700;font-size:15px;">Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø¢Ù†</span>
                </div>
                <button onclick="navigateTo('lessons')" class="btn btn-primary" style="width:100%;padding:15px;font-size:16px;">
                    Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© â†
                </button>
            </div>
            
            <!-- Card 2: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª -->
            <div class="carousel-slide" style="position:absolute;width:100%;opacity:0;transition:opacity 0.5s ease;padding:40px;background:linear-gradient(135deg,rgba(16,185,129,0.15),rgba(5,150,105,0.05));border:2px solid rgba(16,185,129,0.3);border-radius:16px;text-align:center;">
                <div style="width:80px;height:80px;background:linear-gradient(135deg,#10b981,#059669);border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:40px;margin:0 auto 25px;">âœï¸</div>
                <h3 style="font-size:28px;font-weight:800;margin-bottom:15px;color:white;">Ø§Ø®ØªØ¨Ø± Ù†ÙØ³Ùƒ</h3>
                <p style="font-size:16px;line-height:1.8;color:rgba(255,255,255,0.8);margin-bottom:25px;">
                    Ù‡Ù„ ØªØ¹Ø±Ù Ù…Ø¯Ù‰ ØªÙ…ÙƒÙ†Ùƒ Ù…Ù† Ø§Ù„Ø¯Ø±ÙˆØ³ØŸ<br>
                    Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø§Ù„Ø¢Ù† ÙˆØªØ­Ø¯Ù‰ Ù†ÙØ³Ùƒ!
                </p>
                <div style="display:flex;align-items:center;justify-content:space-between;padding:20px;background:rgba(0,0,0,0.2);border-radius:12px;margin-bottom:20px;">
                    <span style="font-size:15px;color:rgba(255,255,255,0.7);">Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ£Ù„Ø¹Ø§Ø¨</span>
                    <span style="color:#10b981;font-weight:700;font-size:15px;">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</span>
                </div>
                <button onclick="navigateTo('tests')" class="btn btn-primary" style="width:100%;padding:15px;font-size:16px;background:linear-gradient(135deg,#10b981,#059669);">
                    Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± â†
                </button>
            </div>
            
            <!-- Card 3: Ø§Ù„Ù„Ø¹Ø¨Ø© -->
            <div class="carousel-slide" style="position:absolute;width:100%;opacity:0;transition:opacity 0.5s ease;padding:40px;background:linear-gradient(135deg,rgba(249,115,22,0.15),rgba(234,88,12,0.05));border:2px solid rgba(249,115,22,0.3);border-radius:16px;text-align:center;">
                <div style="width:80px;height:80px;background:linear-gradient(135deg,#f97316,#ea580c);border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:40px;margin:0 auto 25px;">ğŸ®</div>
                <h3 style="font-size:28px;font-weight:800;margin-bottom:15px;color:white;">ØªØ­Ø¯ÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</h3>
                <p id="gameSlideText" style="font-size:16px;line-height:1.8;color:rgba(255,255,255,0.8);margin-bottom:25px;">
                    ğŸ”¥ Ø­Ø³Ù‘Ù† Ù†ØªÙŠØ¬ØªÙƒ ÙˆØªÙ†Ø§ÙØ³!<br>
                    Ø§Ø±Ø¨Ø­ Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆÙƒÙ† Ø§Ù„Ø£ÙˆÙ„
                </p>
                <div style="display:flex;align-items:center;justify-content:space-between;padding:20px;background:rgba(0,0,0,0.2);border-radius:12px;margin-bottom:20px;">
                    <span id="gameSlideStatus" style="font-size:15px;color:rgba(255,255,255,0.7);">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ</span>
                    <span style="color:#f97316;font-weight:700;font-size:15px;">Ø§Ù„Ø¹Ø¨ Ø§Ù„Ø¢Ù†</span>
                </div>
                <button onclick="navigateTo('levelsScreen')" class="btn btn-primary" style="width:100%;padding:15px;font-size:16px;background:linear-gradient(135deg,#f97316,#ea580c);">
                    Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨ â†
                </button>
            </div>
            
            <!-- Card 4: Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
            <div class="carousel-slide" style="position:absolute;width:100%;opacity:0;transition:opacity 0.5s ease;padding:40px;background:linear-gradient(135deg,rgba(168,85,247,0.15),rgba(147,51,234,0.05));border:2px solid rgba(168,85,247,0.3);border-radius:16px;text-align:center;">
                <div style="width:80px;height:80px;background:linear-gradient(135deg,#a855f7,#9333ea);border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:40px;margin:0 auto 25px;">â­</div>
                <h3 style="font-size:28px;font-weight:800;margin-bottom:15px;color:white;">Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ù…Ù†ØµØ©</h3>
                <p style="font-size:16px;line-height:1.8;color:rgba(255,255,255,0.8);margin-bottom:25px;">
                    ğŸ“Œ ØªÙ… Ø¥Ø¶Ø§ÙØ©<br>
                    60 Ù…Ù„Ù ØªÙ…Ø§Ø±ÙŠÙ† ÙˆØ§Ù…ØªØ­Ø§Ù†Ø§Øª Ø¬Ù‡ÙˆÙŠØ©!
                </p>
                <div style="display:flex;align-items:center;justify-content:space-between;padding:20px;background:rgba(0,0,0,0.2);border-radius:12px;margin-bottom:20px;">
                    <span style="font-size:15px;color:rgba(255,255,255,0.7);">Ø§Ù„ÙŠÙˆÙ…</span>
                    <span style="color:#a855f7;font-weight:700;font-size:15px;">Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø¢Ù†</span>
                </div>
                <button onclick="navigateTo('exercises')" class="btn btn-primary" style="width:100%;padding:15px;font-size:16px;background:linear-gradient(135deg,#a855f7,#9333ea);">
                    Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø¢Ù† â†
                </button>
            </div>
            
            <!-- Card 5: Ø§Ù„ØªØ¬Ø§Ø±Ø¨ -->
            <div class="carousel-slide" style="position:absolute;width:100%;opacity:0;transition:opacity 0.5s ease;padding:40px;background:linear-gradient(135deg,rgba(236,72,153,0.15),rgba(219,39,119,0.05));border:2px solid rgba(236,72,153,0.3);border-radius:16px;text-align:center;">
                <div style="width:80px;height:80px;background:linear-gradient(135deg,#ec4899,#db2777);border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:40px;margin:0 auto 25px;">ğŸ”¬</div>
                <h3 style="font-size:28px;font-weight:800;margin-bottom:15px;color:white;">Ø§ÙƒØªØ´Ù Ø§Ù„ØªØ¬Ø§Ø±Ø¨</h3>
                <p style="font-size:16px;line-height:1.8;color:rgba(255,255,255,0.8);margin-bottom:25px;">
                    Ø§ÙƒØªØ´Ù ØªØ¬Ø§Ø±Ø¨ Ù…Ø°Ù‡Ù„Ø© Ø³ØªØ¬Ø¹Ù„<br>
                    Ù…Ù† ÙÙ‡Ù…Ùƒ Ù„Ù„Ø¯Ø±Ø³ Ø£ÙƒØ«Ø± Ø¨Ø³Ø§Ø·Ø©
                </p>
                <div style="display:flex;align-items:center;justify-content:space-between;padding:20px;background:rgba(0,0,0,0.2);border-radius:12px;margin-bottom:20px;">
                    <span style="font-size:15px;color:rgba(255,255,255,0.7);">ØªØ¬Ø§Ø±Ø¨ ØªÙØ§Ø¹Ù„ÙŠØ©</span>
                    <span style="color:#ec4899;font-weight:700;font-size:15px;">Ø§Ø³ØªÙƒØ´Ù</span>
                </div>
                <button onclick="navigateTo('laboratory')" class="btn btn-primary" style="width:100%;padding:15px;font-size:16px;background:linear-gradient(135deg,#ec4899,#db2777);">
                    Ø§Ø¯Ø®Ù„ Ø§Ù„Ù…Ø®ØªØ¨Ø± â†
                </button>
            </div>
        </div>
        
        <!-- Dots Navigation -->
        <div style="display:flex;justify-content:center;gap:10px;margin-top:25px;">
            <div class="carousel-dot" onclick="goToCard(0)" style="width:12px;height:12px;border-radius:50%;background:var(--primary);cursor:pointer;transition:0.3s;transform:scale(1.3);"></div>
            <div class="carousel-dot" onclick="goToCard(1)" style="width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.3);cursor:pointer;transition:0.3s;"></div>
            <div class="carousel-dot" onclick="goToCard(2)" style="width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.3);cursor:pointer;transition:0.3s;"></div>
            <div class="carousel-dot" onclick="goToCard(3)" style="width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.3);cursor:pointer;transition:0.3s;"></div>
            <div class="carousel-dot" onclick="goToCard(4)" style="width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.3);cursor:pointer;transition:0.3s;"></div>
        </div>
        
    </div>
</section>
                
                <!-- Slide 1: Ø§Ù„Ø¯Ø±ÙˆØ³ -->
                <div class="carousel-slide" style="min-width:100%;padding:40px;background:linear-gradient(135deg,rgba(59,130,246,0.15),rgba(37,99,235,0.05));border:2px solid rgba(59,130,246,0.3);border-radius:16px;text-align:center;">
                    <div style="width:80px;height:80px;background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:40px;margin:0 auto 25px;">ğŸ“š</div>
                    <h3 style="font-size:28px;font-weight:800;margin-bottom:15px;color:white;">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ø±ÙˆØ³</h3>
                    <p style="font-size:16px;line-height:1.8;color:rgba(255,255,255,0.8);margin-bottom:25px;min-height:80px;">
                        Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ø±ÙˆØ³ØŸ<br>
                        Ø´Ø§Ù‡Ø¯ Ø§Ù„Ù…Ù„Ø®ØµØ§Øª ÙˆØ§Ù„Ø´Ø±ÙˆØ­Ø§Øª Ø§Ù„Ù…ÙØµÙ„Ø©
                    </p>
                    <div style="display:flex;align-items:center;justify-content:space-between;padding:20px;background:rgba(0,0,0,0.2);border-radius:12px;margin-bottom:20px;">
                        <span style="font-size:15px;color:rgba(255,255,255,0.7);">6 Ø¯Ø±ÙˆØ³ Ù…ØªØ§Ø­Ø©</span>
                        <span style="color:#3b82f6;font-weight:700;font-size:15px;">Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø¢Ù†</span>
                    </div>
                    <button onclick="navigateTo('lessons')" class="btn btn-primary" style="width:100%;padding:15px;font-size:16px;">
                        Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© â†
                    </button>
                </div>
                
<!-- Lessons -->
<section id="lessons" class="page">
    <h2 style="margin-top:0;margin-bottom:25px;font-size:28px;">ğŸ“š Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
    <div class="cards-grid">
        <div class="card" onclick="openLesson('nervous')">
            <div class="card-icon">ğŸ§ </div>
            <h3 class="card-title">Le systÃ¨me nerveux</h3>
            <p class="card-description">Ø¯Ø±Ø§Ø³Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¹ØµØ¨ÙŠ</p>
        </div>
        <div class="card" onclick="openLesson('muscular')">
            <div class="card-icon">ğŸ’ª</div>
            <h3 class="card-title">Le systÃ¨me musculaire</h3>
            <p class="card-description">ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø¯ÙˆØ± Ø§Ù„Ø¹Ø¶Ù„Ø§Øª</p>
        </div>
        <div class="card" onclick="showImage('microbes.jpg')">
            <div class="card-icon">ğŸ¦ </div>
            <h3 class="card-title">Les microbes</h3>
            <p class="card-description">Ø¹Ø§Ù„Ù… Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©</p>
        </div>
        <div class="card" onclick="openLesson('immune')">
            <div class="card-icon">ğŸ›¡ï¸</div>
            <h3 class="card-title">Le systÃ¨me immunitaire</h3>
            <p class="card-description">Ø§Ù„Ù…Ù†Ø§Ø¹Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© ÙˆØ§Ù„Ù…ÙƒØªØ³Ø¨Ø©</p>
        </div>
        <div class="card" onclick="openLesson('dysfunction')">
            <div class="card-icon">ğŸ”´</div>
            <h3 class="card-title">Dysfonctionnements immunitaires</h3>
            <p class="card-description">Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ø¥ÙŠØ¯Ø²</p>
        </div>
        <div class="card" onclick="showImage('transfusion.jpg')">
            <div class="card-icon">ğŸ’‰</div>
            <h3 class="card-title">La transfusion sanguine</h3>
            <p class="card-description">ÙØµØ§Ø¦Ù„ Ø§Ù„Ø¯Ù… ÙˆÙ†Ù‚Ù„ Ø§Ù„Ø¯Ù…</p>
        </div>
    </div>
</section>

<!-- Lesson Details -->
<section id="lessonDetails" class="page">
    <button class="back-btn" onclick="navigateTo('lessons')">â†’ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯Ø±ÙˆØ³</button>
    <h2 id="lessonTitle" style="margin-bottom:25px;font-size:28px;"></h2>
    <div class="cards-grid" id="lessonParagraphs"></div>
</section>

<!-- Tests -->
<section id="tests" class="page">
    <h2 style="margin-top:0;margin-bottom:25px;font-size:28px;">âœï¸ Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ</h2>
    <div class="cards-grid">
        <div class="card" onclick="navigateTo('quizTopics')">
            <div class="card-icon">ğŸ“</div>
            <h3 class="card-title">Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙØ©</h3>
            <p class="card-description">Ù‚ÙŠÙ‘Ù… Ù…Ø¹Ø±ÙØªÙƒ Ø§Ù„Ù†Ø¸Ø±ÙŠØ©</p>
        </div>
        <div class="card">
            <div class="card-icon">ğŸ¯</div>
            <h3 class="card-title">Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</h3>
            <p class="card-description">Ø§Ø®ØªØ¨Ø± Ù‚Ø¯Ø±ØªÙƒ Ø¹Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</p>
            <div style="margin-top:10px;padding:5px 12px;background:var(--accent);border-radius:20px;display:inline-block;font-size:12px;">Ù‚Ø±ÙŠØ¨Ø§Ù‹</div>
        </div>
        <div class="card" onclick="navigateTo('levelsScreen')">
            <div class="card-icon">ğŸ®</div>
            <h3 class="card-title">Ø£Ù„Ø¹Ø§Ø¨ ØªØ±Ø¨ÙˆÙŠØ©</h3>
            <p class="card-description">ØªØ¹Ù„Ù… ÙˆØªØ³Ù„Ù‰ ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª</p>
        </div>
    </div>
</section>

<!-- Quiz Topics -->
<section id="quizTopics" class="page">
    <button class="back-btn" onclick="navigateTo('tests')">â†’ Ø§Ù„Ø±Ø¬ÙˆØ¹</button>
    <h2 style="margin-bottom:30px;font-size:28px;">ğŸ“ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙØ©</h2>
    <div class="cards-grid">
        <div class="card" onclick="selectQuizTopic('fonctions')">
            <div class="card-icon" style="background:linear-gradient(135deg,#3b82f6,#2563eb);">ğŸ§ </div>
            <h3 class="card-title">Les fonctions de relation</h3>
            <p class="card-description">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ø±ÙØªÙƒ ÙÙŠ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©</p>
        </div>
        <div class="card" onclick="selectQuizTopic('immunologie')">
            <div class="card-icon" style="background:linear-gradient(135deg,#f59e0b,#f97316);">ğŸ›¡ï¸</div>
            <h3 class="card-title">Immunologie</h3>
            <p class="card-description">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ø±ÙØªÙƒ ÙÙŠ Ø§Ù„Ù…Ù†Ø§Ø¹Ø©</p>
            <div style="margin-top:10px;padding:5px 12px;background:var(--accent);border-radius:20px;display:inline-block;font-size:12px;">Ù‚Ø±ÙŠØ¨Ø§Ù‹</div>
        </div>
    </div>
</section>

<!-- Quiz Levels -->
<section id="quizLevels" class="page">
    <button class="back-btn" onclick="navigateTo('quizTopics')">â†’ Ø§Ù„Ø±Ø¬ÙˆØ¹</button>
    <h2 id="quizTopicTitle" style="margin-bottom:30px;font-size:28px;"></h2>
    <div style="max-width:800px;margin:0 auto;">
        <div class="cards-grid">
            <div class="card" onclick="startQuiz('easy')">
                <div class="card-icon" style="background:linear-gradient(135deg,#10b981,#059669);">ğŸ˜Š</div>
                <h3 class="card-title">Ù…Ø³ØªÙˆÙ‰ Ø³Ù‡Ù„</h3>
                <p class="card-description">20 Ø³Ø¤Ø§Ù„Ø§Ù‹ Ø¨Ø³ÙŠØ·Ø§Ù‹<br>15 Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© Ù„Ù„Ù†Ø¬Ø§Ø­</p>
            </div>
            <div class="card" id="mediumLevel" style="opacity:0.5;cursor:not-allowed;">
                <div class="card-icon" style="background:linear-gradient(135deg,#f59e0b,#f97316);">ğŸ¤”</div>
                <h3 class="card-title">Ù…Ø³ØªÙˆÙ‰ Ù…ØªÙˆØ³Ø·</h3>
                <p class="card-description">30 Ø³Ø¤Ø§Ù„Ø§Ù‹ Ù…ØªÙ†ÙˆØ¹Ø§Ù‹<br>25 Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© Ù„Ù„Ù†Ø¬Ø§Ø­</p>
                <div style="position:absolute;top:15px;right:15px;font-size:24px;">ğŸ”’</div>
            </div>
            <div class="card" id="hardLevel" style="opacity:0.5;cursor:not-allowed;">
                <div class="card-icon" style="background:linear-gradient(135deg,#ef4444,#dc2626);">ğŸ˜¤</div>
                <h3 class="card-title">Ù…Ø³ØªÙˆÙ‰ ØµØ¹Ø¨</h3>
                <p class="card-description">40 Ø³Ø¤Ø§Ù„Ø§Ù‹ Ù…ØªÙ†ÙˆØ¹Ø§Ù‹<br>32 Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© Ù„Ù„Ù†Ø¬Ø§Ø­</p>
                <div style="position:absolute;top:15px;right:15px;font-size:24px;">ğŸ”’</div>
            </div>
        </div>
    </div>
</section>

<!-- Quiz Screen -->
<section id="quizScreen" class="page">
    <div style="max-width:900px;margin-left:auto;margin-right:auto;">
        <div style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:20px;margin-bottom:25px;display:grid;grid-template-columns:repeat(3,1fr);gap:15px;">
            <div style="text-align:center;">
                <div style="font-size:12px;color:var(--gray);margin-bottom:5px;">Ø§Ù„Ø³Ø¤Ø§Ù„</div>
                <div style="font-size:24px;font-weight:700;color:var(--primary);" id="quizProgress">1/20</div>
            </div>
            <div style="text-align:center;">
                <div style="font-size:12px;color:var(--gray);margin-bottom:5px;">ØµØ­ÙŠØ­Ø©</div>
                <div style="font-size:24px;font-weight:700;color:var(--success);" id="quizCorrect">0</div>
            </div>
            <div style="text-align:center;">
                <div style="font-size:12px;color:var(--gray);margin-bottom:5px;">Ø®Ø§Ø·Ø¦Ø©</div>
                <div style="font-size:24px;font-weight:700;color:var(--danger);" id="quizWrong">0</div>
            </div>
        </div>
        
        <div style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:40px;">
            <h3 style="font-size:22px;font-weight:700;margin-bottom:30px;line-height:1.8;text-align:center;" id="quizQuestion"></h3>
            <div id="quizOptions" style="display:flex;flex-direction:column;gap:15px;"></div>
            <div id="quizFeedback" style="display:none;margin-top:25px;padding:20px;border-radius:12px;"></div>
            <button id="quizNextBtn" style="display:none;margin-top:20px;width:100%;" class="btn btn-primary" onclick="nextQuizQuestion()">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
        </div>
    </div>
</section>


<!-- Laboratory -->
<section id="laboratory" class="page">
    <h2 style="margin-top:0;margin-bottom:25px;font-size:28px;">ğŸ§ª Ø§Ù„Ù…Ø®ØªØ¨Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</h2>
    <div style="text-align:center;padding:80px 20px;">
        <div style="font-size:80px;opacity:0.3;">ğŸ”¬</div>
        <h3 style="font-size:24px;margin:20px 0 10px;">Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¬Ø¯Ø§Ù‹!</h3>
        <p style="color:var(--gray);line-height:1.8;">
            Ù†Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø¥Ø¶Ø§ÙØ© ØªØ¬Ø§Ø±Ø¨ ØªÙØ§Ø¹Ù„ÙŠØ© Ù…Ø°Ù‡Ù„Ø©<br>
            Ø³ØªØ¬Ø¹Ù„ Ù…Ù† ÙÙ‡Ù…Ùƒ Ù„Ù„Ø¯Ø±ÙˆØ³ Ø£ÙƒØ«Ø± Ø¨Ø³Ø§Ø·Ø© ÙˆÙ…ØªØ¹Ø©
        </p>
    </div>
</section>

<!-- Exercises -->
<section id="exercises" class="page">
    <h2 style="margin-top:0;margin-bottom:25px;font-size:28px;">ğŸ“ Ø³Ù„Ø§Ø³Ù„ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</h2>
    <div style="text-align:center;padding:80px 20px;">
        <div style="font-size:80px;opacity:0.3;">ğŸ“</div>
        <h3 style="font-size:24px;margin:20px 0 10px;">Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¬Ø¯Ø§Ù‹!</h3>
        <p style="color:var(--gray);">Ù†Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§Ø³Ù„ ØªÙ…Ø§Ø±ÙŠÙ† Ø´Ø§Ù…Ù„Ø©</p>
    </div>
</section>

<!-- Videos -->
<section id="videos" class="page">
    <h2 style="margin-top:0;margin-bottom:25px;font-size:28px;">ğŸ¥ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h2>
    <div style="text-align:center;padding:80px 20px;">
        <div style="font-size:80px;opacity:0.3;">ğŸ¥</div>
        <h3 style="font-size:24px;margin:20px 0 10px;">Ù…Ø­ØªÙˆÙ‰ Ù‚Ø§Ø¯Ù…!</h3>
        <p style="color:var(--gray);">Ø³Ù†Ø¶ÙŠÙ Ù…ÙƒØªØ¨Ø© Ù…Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
    </div>
</section>

<!-- Levels Selection -->
<section id="levelsScreen" class="page">
    <button class="back-btn" onclick="navigateTo('tests')">â†’ Ø§Ù„Ø±Ø¬ÙˆØ¹</button>
    <div style="text-align:center;margin-bottom:25px;">
        <button class="btn btn-primary" onclick="showLeaderboard()" style="padding:12px 25px;">ğŸ† Ù„Ø§Ø¦Ø­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</button>
    </div>
    <h2 style="font-size:32px;font-weight:800;text-align:center;margin-bottom:30px;">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªÙˆÙ‰</h2>
    <div class="levels-grid" id="levelsGrid"></div>
</section>

<!-- Game Screen -->
<section id="gameScreen" class="page">
    <div class="game-content">
        <div class="question-card">
            <div class="clue-box">
                <div class="clue-label">ğŸ’¡ Ø§Ù„Ø¯Ù„ÙŠÙ„ / L'indice</div>
                <div class="clue-text" id="clueText"></div>
            </div>
            
            <div class="answer-section">
                <div class="answer-label">âœï¸ Ø±ØªÙ‘Ø¨ Ø§Ù„Ø­Ø±ÙˆÙ Ù‡Ù†Ø§</div>
                <div class="answer-slots" id="answerSlots"></div>
            </div>
            
            <div class="choices-section">
                <div class="choices-label">ğŸ”¡ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ù…ØªØ§Ø­Ø©</div>
                <div class="letter-choices" id="letterChoices"></div>
            </div>
            
            <div class="game-actions">
                <button class="btn btn-ghost" onclick="resetLetters()">â†º Ø¥Ø¹Ø§Ø¯Ø©</button>
                <button class="btn btn-warning" onclick="useHint()" id="hintBtn">ğŸ’¡ Ù…Ø³Ø§Ø¹Ø¯Ø© (-5)</button>
                <button class="btn btn-danger" onclick="skipQuestion()">â­ ØªØ®Ø·ÙŠ (-10)</button>
                <button class="btn btn-primary" onclick="checkAnswer()">âœ” ØªØ­Ù‚Ù‚</button>
            </div>
        </div>
    </div>
</section>

<!-- Leaderboard -->
<section id="leaderboardScreen" class="page">
    <button class="back-btn" onclick="navigateTo('levelsScreen')">â†’ Ø§Ù„Ø±Ø¬ÙˆØ¹</button>
    <div class="leaderboard">
        <h2 class="leaderboard-title">ğŸ† Ù„Ø§Ø¦Ø­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</h2>
        <div class="leaderboard-table">
            <div class="leaderboard-row header">
                <div>Ø§Ù„ØªØ±ØªÙŠØ¨</div>
                <div>Ø§Ù„Ø§Ø³Ù…</div>
                <div>Ø§Ù„Ù†Ù‚Ø§Ø·</div>
                <div>Ø§Ù„ÙˆÙ‚Øª</div>
            </div>
            <div id="leaderboardList"></div>
        </div>
    </div>
</section>

</main>

<!-- Feedback -->
<div class="feedback-overlay" id="feedback"></div>

<script>
// === LESSONS DATA ===
const lessonsData = {
    nervous: {
        title: 'ğŸ§  Le systÃ¨me nerveux',
        paragraphs: [
            { title: "L'organisation", image: 'nervous_1.jpg' },
            { title: 'La sensibilitÃ© consciente', image: 'nervous_2.jpg' },
            { title: 'La motricitÃ© volontaire', image: 'nervous_3.jpg' },
            { title: 'MotricitÃ© involontaire', image: 'nervous_4.jpg' },
            { title: 'HygiÃ¨ne', image: 'nervous_5.jpg' }
        ]
    },
    muscular: {
        title: 'ğŸ’ª Le systÃ¨me musculaire',
        paragraphs: [
            { title: 'RÃ´le du muscle', image: 'muscular_1.jpg' },
            { title: 'Structure', image: 'muscular_2.jpg' },
            { title: 'Besoins', image: 'muscular_3.jpg' }
        ]
    },
    immune: {
        title: 'ğŸ›¡ï¸ Le systÃ¨me immunitaire',
        paragraphs: [
            { title: 'ImmunitÃ© naturelle', image: 'immune_1.jpg' },
            { title: 'ImmunitÃ© spÃ©cifique', image: 'immune_2.jpg' },
            { title: 'Organes lymphoÃ¯des', image: 'immune_3.jpg' },
            { title: 'Renforcement', image: 'immune_4.jpg' }
        ]
    },
    dysfunction: {
        title: 'ğŸ”´ Dysfonctionnements immunitaires',
        paragraphs: [
            { title: 'Allergies', image: 'dysfunction_1.jpg' },
            { title: 'SIDA', image: 'dysfunction_2.jpg' }
        ]
    }
};

// === GAME DATA ===
const levelsData = [
    // Level 1
    [
        { answer: 'CERVEAU', clue: 'centre nerveux / Ù…Ø±ÙƒØ² Ø¹ØµØ¨ÙŠ', extra: ['T','M','N','K','P','X','B','L','A','R','D','F','G'] },
        { answer: 'MOELLE EPINIERE', clue: 'centre nerveux central / Ù…Ø±ÙƒØ² Ø¹ØµØ¨ÙŠ Ù…Ø±ÙƒØ²ÙŠ', extra: ['X','T','K','A','B'] },
        { answer: 'NERFS', clue: 'organe nerveux pÃ©riphÃ©rique / Ø¹Ø¶Ùˆ Ø¹ØµØ¨ÙŠ Ù…Ø­ÙŠØ·ÙŠ', extra: ['T','M','A','K','L','X','B','P','D','G','H','J','Q','W','Z'] },
        { answer: 'CORPS CELLULAIRE', clue: 'situÃ© dans la substance grise / ÙŠÙ‚Ø¹ ÙÙŠ Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø±Ù…Ø§Ø¯ÙŠØ©', extra: ['X','T','K','M'] },
        { answer: 'AXONE', clue: 'situÃ© dans la substance blanche / ÙŠÙ‚Ø¹ ÙÙŠ Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡', extra: ['R','T','M','L','P','K','B','D','F','G','H','J','Q','W','Z'] },
        { answer: 'FIBRE NERVEUSE', clue: 'unitÃ© structurelle du nerf / ÙˆØ­Ø¯Ø© Ø¨Ù†ÙŠÙˆÙŠØ© Ù„Ù„Ø¹ØµØ¨', extra: ['X','T','K','M','L','P'] },
        { answer: 'NEURONE', clue: 'cellule nerveuse / Ø§Ù„Ø®Ù„ÙŠØ© Ø§Ù„Ø¹ØµØ¨ÙŠØ©', extra: ['B','M','T','X','K','A','L','P','D','F','G','H','J'] },
        { answer: 'SYNAPSE', clue: 'zone entre deux neurones / Ù…Ù†Ø·Ù‚Ø© Ø¨ÙŠÙ† Ø¹ØµØ¨ÙˆÙ†ÙŠÙ†', extra: ['K','L','M','T','X','B','D','F','G','H','J','Q','W'] },
        { answer: 'GANGLION SPINAL', clue: 'situÃ© au niveau de la racine dorsale / ÙŠÙ‚Ø¹ Ø¹Ù†Ø¯ Ø§Ù„Ø¬Ø°Ø± Ø§Ù„Ø¸Ù‡Ø±ÙŠ', extra: ['X','T','K','M','B'] },
        { answer: 'NERF MIXTE', clue: 'transmet l\'influx nerveux sensitif et moteur / ÙŠÙ†Ù‚Ù„ Ø§Ù„Ø³ÙŠØ§Ù„Ø© Ø§Ù„Ø¹ØµØ¨ÙŠØ© Ø§Ù„Ø­Ø³ÙŠØ© ÙˆØ§Ù„Ø­Ø±ÙƒÙŠØ©', extra: ['B','K','A','L','P','D','G','H','J','Q'] }
    ],
    // Levels 2-10 (temporary placeholder data)
    ...Array(9).fill([
        { answer: 'CERVEAU', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['T','M','N','K','P','X','B','L','A','R','D','F','G'] },
        { answer: 'NEURONE', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['X','B','L','K','A','T','M','P','D','F','G','H','J'] },
        { answer: 'REFLEXE', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['M','T','A','P','W','K','B','D','F','G','H','J','Q'] },
        { answer: 'MUSCLE', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['T','B','N','D','P','X','A','K','F','G','H','J','Q','W'] },
        { answer: 'VACCIN', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['X','R','T','M','L','P','B','K','D','F','G','H','J','Q'] },
        { answer: 'MICROBE', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['K','A','T','S','X','P','D','F','G','H','J','Q','W','Z'] },
        { answer: 'SANG', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['B','P','T','M','R','K','L','X','D','F','G','H','J','Q','W','Z'] },
        { answer: 'SYSTEME', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['A','B','K','T','X','M','P','D','F','G','H','J','Q'] },
        { answer: 'IMMUNE', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['X','K','T','A','B','P','D','F','G','H','J','Q','W','Z'] },
        { answer: 'ORGANE', clue: 'Ø³Ø¤Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ - Ù‚Ø±ÙŠØ¨Ø§Ù‹', extra: ['X','B','M','K','T','P','D','F','G','H','J','Q','W','Z'] }
    ])
];

// Game State
const gameState = {
    playerName: 'Player',
    currentLevel: 0,
    currentQuestion: 0,
    points: 0,
    startTime: 0,
    selectedLetters: [],
    availableLetters: [],
    isChecking: false,
    hintedPositions: [],
    currentAnswer: ''
};

// === STORAGE FUNCTIONS ===
function loadProgress() {
    const saved = localStorage.getItem('heptaGameProgress');
    if (saved) return JSON.parse(saved);
    return { unlockedLevels: 1, levelStars: {}, bestScores: {} };
}

function saveProgress(progress) {
    localStorage.setItem('heptaGameProgress', JSON.stringify(progress));
}

function loadLeaderboard() {
    const saved = localStorage.getItem('heptaLeaderboard');
    if (saved) return JSON.parse(saved);
    return [];
}

function saveLeaderboard(leaderboard) {
    localStorage.setItem('heptaLeaderboard', JSON.stringify(leaderboard));
}

// === NAME INPUT ===
function checkNameInput() {
    const firstName = document.getElementById('firstName').value.trim();
    const lastName = document.getElementById('lastName').value.trim();
    const btn = document.getElementById('startBtn');
    const error = document.getElementById('nameError');
    
    if (firstName.length >= 2 && lastName.length >= 2) {
        btn.disabled = false;
        
        // Check if name exists
        const fullName = firstName + ' ' + lastName;
        const leaderboard = loadLeaderboard();
        const exists = leaderboard.some(entry => entry.name.toLowerCase() === fullName.toLowerCase());
        
        if (exists) {
            error.style.display = 'block';
        } else {
            error.style.display = 'none';
        }
    } else {
        btn.disabled = true;
        error.style.display = 'none';
    }
}

function submitName() {
    const firstName = document.getElementById('firstName').value.trim();
    const lastName = document.getElementById('lastName').value.trim();
    
    if (firstName.length < 2 || lastName.length < 2) {
        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù†Ø³Ø¨ (Ø­Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„ÙƒÙ„ Ù…Ù†Ù‡Ù…Ø§)');
        return;
    }
    
    const fullName = firstName + ' ' + lastName;
    
    // Check if name exists
    const leaderboard = loadLeaderboard();
    const exists = leaderboard.some(entry => entry.name.toLowerCase() === fullName.toLowerCase());
    
    if (exists) {
        alert('Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„! Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ø³Ù… Ø¢Ø®Ø±');
        return;
    }
    
    // Save name
    gameState.playerName = fullName;
    localStorage.setItem('heptaPlayerName', fullName);
    
    // Show name in navbar
    document.getElementById('userNameText').textContent = fullName;
    document.getElementById('userNameDisplay').style.display = 'block';
    
    // Update dashboard name
    const dashboardNameEl = document.getElementById('dashboardName');
    if (dashboardNameEl) dashboardNameEl.textContent = firstName;
    
    // Show welcome message
    const overlay = document.getElementById('feedback');
    overlay.innerHTML = `
        <div class="feedback-card">
            <div class="feedback-icon">ğŸ‰</div>
            <div class="feedback-title success">Ù…Ø±Ø­Ø¨Ø§Ù‹ ${firstName}!</div>
            <div class="feedback-msg">Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ØªØ¬Ø±Ø¨Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…Ù…ØªØ¹Ø© ğŸŒŸ</div>
        </div>
    `;
    overlay.classList.add('active');
    
    setTimeout(() => {
        overlay.classList.remove('active');
        navigateTo('dashboard');
        setTimeout(() => initCardRotation(), 100);
    }, 2000);
}

// Check if user already logged in
window.addEventListener('DOMContentLoaded', () => {
    const savedName = localStorage.getItem('heptaPlayerName');
    if (savedName) {
        gameState.playerName = savedName;
        document.getElementById('userNameText').textContent = savedName;
        document.getElementById('userNameDisplay').style.display = 'block';
        
        // Update dashboard name
        const firstName = savedName.split(' ')[0];
        const dashboardNameEl = document.getElementById('dashboardName');
        if (dashboardNameEl) dashboardNameEl.textContent = firstName;
        
        // Update game slide based on progress
        const progress = loadProgress();
        const gameSlideText = document.getElementById('gameSlideText');
        const gameSlideStatus = document.getElementById('gameSlideStatus');
        
        if (gameSlideText && gameSlideStatus) {
            const highestLevel = progress.unlockedLevels || 1;
            const totalStars = Object.values(progress.levelStars || {}).reduce((a, b) => a + b, 0);
            
            if (highestLevel > 1 || totalStars > 0) {
                gameSlideText.innerHTML = `ğŸ”¥ Ø­Ø³Ù‘Ù† Ù†ØªÙŠØ¬ØªÙƒ!<br>Ø§Ù„Ù…Ø³ØªÙˆÙ‰: ${highestLevel} | â­ ${totalStars}`;
                gameSlideStatus.textContent = 'ÙˆØ§ØµÙ„ Ø§Ù„Ù„Ø¹Ø¨';
            } else {
                gameSlideText.innerHTML = `ğŸ® Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ!<br>Ù„Ù… ØªØ¬Ø±Ø¨ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø¹Ø¯ØŸ`;
                gameSlideStatus.textContent = 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†';
            }
        }
        
        navigateTo('dashboard');
        initCardRotation();
    }
});

// === CARD ROTATION ===
let currentCard = 0;
let cardRotationInterval;

function showCard(index) {
    const cards = document.querySelectorAll('.carousel-slide');
    const dots = document.querySelectorAll('.carousel-dot');
    
    cards.forEach((card, i) => {
        if (i === index) {
            card.style.opacity = '1';
            card.style.zIndex = '1';
        } else {
            card.style.opacity = '0';
            card.style.zIndex = '0';
        }
    });
    
    dots.forEach((dot, i) => {
        if (i === index) {
            dot.style.background = 'var(--primary)';
            dot.style.transform = 'scale(1.3)';
        } else {
            dot.style.background = 'rgba(255,255,255,0.3)';
            dot.style.transform = 'scale(1)';
        }
    });
}

function carouselNext() {
    currentCard = (currentCard + 1) % 5;
    showCard(currentCard);
    resetCardRotation();
}

function carouselPrev() {
    currentCard = (currentCard - 1 + 5) % 5;
    showCard(currentCard);
    resetCardRotation();
}

function goToCard(index) {
    currentCard = index;
    showCard(currentCard);
    resetCardRotation();
}

function startCardRotation() {
    cardRotationInterval = setInterval(() => {
        carouselNext();
    }, 3000);
}

function stopCardRotation() {
    if (cardRotationInterval) {
        clearInterval(cardRotationInterval);
    }
}

function resetCardRotation() {
    stopCardRotation();
    startCardRotation();
}

function initCardRotation() {
    const dashboard = document.getElementById('dashboard');
    if (dashboard && dashboard.classList.contains('active')) {
        showCard(0);
        startCardRotation();
    }
}

// === NAVIGATION ===
function toggleSidebar() {
    document.getElementById('sidebar').classList.toggle('active');
    document.getElementById('sidebarOverlay').classList.toggle('active');
}

function closeSidebar() {
    document.getElementById('sidebar').classList.remove('active');
    document.getElementById('sidebarOverlay').classList.remove('active');
}

function navigateTo(page) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(page).classList.add('active');
    document.getElementById('gameHud').classList.remove('active');
    
    document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
    closeSidebar();
    window.scrollTo(0, 0);
    
    if (page === 'levelsScreen') {
        renderLevels();
    }
    
    // Control carousel
    if (page === 'dashboard') {
        initCardRotation();
    } else {
        stopCardRotation();
    }
}

// === LESSONS ===
function openLesson(key) {
    const lesson = lessonsData[key];
    document.getElementById('lessonTitle').textContent = lesson.title;
    const container = document.getElementById('lessonParagraphs');
    container.innerHTML = '';
    lesson.paragraphs.forEach(p => {
        const card = document.createElement('div');
        card.className = 'card';
        card.onclick = () => showImage(p.image, p.title);
        card.innerHTML = `
            <div class="card-icon">ğŸ“„</div>
            <h4 class="card-title">${p.title}</h4>
        `;
        container.appendChild(card);
    });
    navigateTo('lessonDetails');
}

function showImage(path) {
    const popup = document.createElement('div');
    popup.className = 'popup active';
    popup.innerHTML = `
        <div class="popup-content">
            <button class="popup-close" onclick="this.parentElement.parentElement.remove()">âœ–</button>
            <img class="popup-img" src="${path}" onerror="alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©')">
        </div>
    `;
    document.body.appendChild(popup);
}

// === QUIZ SYSTEM ===
const quizData = {
    fonctions: {
        easy: [
{"id":1,"question":"Quel organe fait partie du systÃ¨me nerveux central ?","options":["L'encÃ©phale","Le muscle","L'os"],"answer":"L'encÃ©phale"},
{"id":2,"question":"Quel est le rÃ´le des rÃ©cepteurs sensoriels dans la peau ?","options":["Produire le mouvement","Capter les stimulus extÃ©rieurs","Analyser les messages"],"answer":"Capter les stimulus extÃ©rieurs"},
{"id":3,"question":"OÃ¹ naÃ®t l'influx nerveux moteur lors d'un mouvement volontaire ?","options":["Dans l'aire motrice","Dans la moelle Ã©piniÃ¨re","Dans l'Å“il"],"answer":"Dans l'aire motrice"},
{"id":4,"question":"Le nerf sciatique est un conducteur :","options":["Uniquement sensitif","Uniquement moteur","Mixte"],"answer":"Mixte"},
{"id":5,"question":"Quel est le centre nerveux responsable des rÃ©flexes mÃ©dullaires ?","options":["Le cerveau","La moelle Ã©piniÃ¨re","Le cervelet"],"answer":"La moelle Ã©piniÃ¨re"},
{"id":6,"question":"Comment appelle-t-on l'unitÃ© structurelle du systÃ¨me nerveux ?","options":["La fibre musculaire","Le neurone","Le tendon"],"answer":"Le neurone"},
{"id":7,"question":"Quelle est la propriÃ©tÃ© du muscle qui lui permet de se raccourcir ?","options":["L'Ã©lasticitÃ©","L'excitabilitÃ©","La contractilitÃ©"],"answer":"La contractilitÃ©"},
{"id":8,"question":"Le muscle squelettique est reliÃ© Ã  l'os par :","options":["Les tendons","Les nerfs","Les vaisseaux"],"answer":"Les tendons"},
{"id":9,"question":"Quels sont les besoins de la contraction musculaire ?","options":["Glucose et OxygÃ¨ne","CO2 et Eau","Graisse et Azote"],"answer":"Glucose et OxygÃ¨ne"},
{"id":10,"question":"La zone de contact entre neurone et muscle est :","options":["L'aire de Broca","La plaque motrice","Le corps cellulaire"],"answer":"La plaque motrice"},
{"id":11,"question":"L'arc rÃ©flexe concerne quel type de mouvement ?","options":["Volontaire","Involontaire","Le sommeil"],"answer":"Involontaire"},
{"id":12,"question":"Quelle substance nuit gravement aux rÃ©flexes ?","options":["L'eau","Les vitamines","L'alcool"],"answer":"L'alcool"},
{"id":13,"question":"L'aire visuelle sert Ã  :","options":["Entendre","Voir","GoÃ»ter"],"answer":"Voir"},
{"id":14,"question":"Une fibre musculaire est une :","options":["Cellule","BactÃ©rie","ProtÃ©ine"],"answer":"Cellule"},
{"id":15,"question":"L'influx nerveux sensitif se dirige vers :","options":["Les muscles","Les centres nerveux","La peau"],"answer":"Les centres nerveux"},
{"id":16,"question":"L'organe qui exÃ©cute le mouvement est :","options":["Le nerf","Le muscle","L'Å“il"],"answer":"Le muscle"},
{"id":17,"question":"La matiÃ¨re grise du cerveau est situÃ©e en :","options":["PÃ©riphÃ©rie","Centre","Bas"],"answer":"PÃ©riphÃ©rie"},
{"id":18,"question":"Le stimulus de l'oreille est :","options":["La lumiÃ¨re","Le son","L'odeur"],"answer":"Le son"},
{"id":19,"question":"Le manque de sommeil fatigue quel systÃ¨me ?","options":["Nerveux","Digestif","Urinaire"],"answer":"Nerveux"},
{"id":20,"question":"Le cerveau est protÃ©gÃ© par :","options":["Le crÃ¢ne","La peau uniquement","Les muscles"],"answer":"Le crÃ¢ne"}
        ]
    }
};

const quizState = {
    currentTopic: '',
    currentLevel: '',
    currentQuestionIndex: 0,
    correctAnswers: 0,
    wrongAnswers: 0,
    answered: false
};

function selectQuizTopic(topic) {
    quizState.currentTopic = topic;
    document.getElementById('quizTopicTitle').textContent = 'ğŸ§  Les fonctions de relation';
    navigateTo('quizLevels');
}

function startQuiz(level) {
    quizState.currentLevel = level;
    quizState.currentQuestionIndex = 0;
    quizState.correctAnswers = 0;
    quizState.wrongAnswers = 0;
    navigateTo('quizScreen');
    loadQuizQuestion();
}

function loadQuizQuestion() {
    const questions = quizData[quizState.currentTopic][quizState.currentLevel];
    const question = questions[quizState.currentQuestionIndex];
    
    quizState.answered = false;
    
    document.getElementById('quizProgress').textContent = `${quizState.currentQuestionIndex + 1}/20`;
    document.getElementById('quizCorrect').textContent = quizState.correctAnswers;
    document.getElementById('quizWrong').textContent = quizState.wrongAnswers;
    document.getElementById('quizQuestion').textContent = question.question;
    
    const container = document.getElementById('quizOptions');
    container.innerHTML = '';
    
    question.options.forEach(option => {
        const btn = document.createElement('button');
        btn.textContent = option;
        btn.onclick = () => checkQuizAnswer(option, question.answer, btn);
        btn.style.cssText = 'width:100%;padding:18px 25px;background:rgba(255,255,255,0.05);border:2px solid rgba(255,255,255,0.1);border-radius:12px;color:white;font-size:16px;font-weight:600;cursor:pointer;transition:0.3s;text-align:right;font-family:Cairo,sans-serif;';
        btn.onmouseover = () => {
            if (!quizState.answered) {
                btn.style.background = 'rgba(99,102,241,0.2)';
                btn.style.borderColor = 'var(--primary)';
            }
        };
        btn.onmouseout = () => {
            if (!quizState.answered) {
                btn.style.background = 'rgba(255,255,255,0.05)';
                btn.style.borderColor = 'rgba(255,255,255,0.1)';
            }
        };
        container.appendChild(btn);
    });
    
    document.getElementById('quizFeedback').style.display = 'none';
    document.getElementById('quizNextBtn').style.display = 'none';
}

function checkQuizAnswer(selected, correct, btn) {
    if (quizState.answered) return;
    quizState.answered = true;
    
    const isCorrect = selected === correct;
    const allOptions = document.querySelectorAll('#quizOptions button');
    
    allOptions.forEach(opt => {
        opt.style.cursor = 'not-allowed';
        if (opt.textContent === correct) {
            opt.style.background = 'rgba(16,185,129,0.2)';
            opt.style.borderColor = 'var(--success)';
            opt.innerHTML = 'âœ… ' + opt.textContent;
        }
        if (opt === btn && !isCorrect) {
            opt.style.background = 'rgba(239,68,68,0.2)';
            opt.style.borderColor = 'var(--danger)';
            opt.innerHTML = 'âŒ ' + opt.textContent;
        }
    });
    
    if (isCorrect) {
        quizState.correctAnswers++;
        document.getElementById('quizCorrect').textContent = quizState.correctAnswers;
    } else {
        quizState.wrongAnswers++;
        document.getElementById('quizWrong').textContent = quizState.wrongAnswers;
    }
    
    const feedback = document.getElementById('quizFeedback');
    feedback.style.display = 'block';
    
    if (isCorrect) {
        feedback.style.background = 'rgba(16,185,129,0.15)';
        feedback.style.border = '1px solid rgba(16,185,129,0.3)';
        feedback.innerHTML = '<div style="font-size:20px;margin-bottom:5px;">âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!</div><div style="font-size:14px;color:rgba(255,255,255,0.7);">Ø£Ø­Ø³Ù†Øª! ÙˆØ§ØµÙ„ Ø§Ù„ØªÙ‚Ø¯Ù…</div>';
    } else {
        feedback.style.background = 'rgba(239,68,68,0.15)';
        feedback.style.border = '1px solid rgba(239,68,68,0.3)';
        feedback.innerHTML = `<div style="font-size:20px;margin-bottom:5px;">âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©</div><div style="font-size:14px;color:rgba(255,255,255,0.7);">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: ${correct}</div>`;
    }
    
    document.getElementById('quizNextBtn').style.display = 'block';
}

function nextQuizQuestion() {
    quizState.currentQuestionIndex++;
    
    if (quizState.currentQuestionIndex >= 20) {
        finishQuiz();
    } else {
        loadQuizQuestion();
    }
}

function finishQuiz() {
    const passed = quizState.correctAnswers >= 15;
    const overlay = document.getElementById('feedback');
    
    if (passed) {
        overlay.innerHTML = `
            <div class="feedback-card">
                <div class="feedback-icon">ğŸ‰</div>
                <div class="feedback-title success">Ù†Ø¬Ø­Øª ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!</div>
                <div class="feedback-msg">Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø£Ø¬Ø¨Øª Ø¹Ù„Ù‰ ${quizState.correctAnswers}/20 Ø³Ø¤Ø§Ù„Ø§Ù‹ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</div>
                <div style="margin:20px 0;">
                    <div style="margin:10px 0;">Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©: <strong style="color:var(--success);">${quizState.correctAnswers}</strong></div>
                    <div style="margin:10px 0;">Ø¥Ø¬Ø§Ø¨Ø§Øª Ø®Ø§Ø·Ø¦Ø©: <strong style="color:var(--danger);">${quizState.wrongAnswers}</strong></div>
                </div>
                <button class="btn btn-primary" onclick="document.getElementById('feedback').classList.remove('active'); navigateTo('quizLevels');">Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø¢Ø®Ø±</button>
            </div>
        `;
    } else {
        overlay.innerHTML = `
            <div class="feedback-card">
                <div class="feedback-icon">ğŸ˜</div>
                <div class="feedback-title" style="color:var(--danger);">Ù„Ù„Ø£Ø³ÙØŒ Ù„Ù… ØªÙ†Ø¬Ø­</div>
                <div class="feedback-msg">ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ 15 Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„. Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ${quizState.correctAnswers}/20</div>
                <div style="margin:20px 0;">
                    <div style="margin:10px 0;">Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©: <strong style="color:var(--success);">${quizState.correctAnswers}</strong></div>
                    <div style="margin:10px 0;">Ø¥Ø¬Ø§Ø¨Ø§Øª Ø®Ø§Ø·Ø¦Ø©: <strong style="color:var(--danger);">${quizState.wrongAnswers}</strong></div>
                </div>
                <div style="display:flex;gap:10px;justify-content:center;">
                    <button class="btn btn-primary" onclick="document.getElementById('feedback').classList.remove('active'); startQuiz('easy');">Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
                    <button class="btn btn-ghost" onclick="document.getElementById('feedback').classList.remove('active'); navigateTo('quizLevels');">Ø¹ÙˆØ¯Ø©</button>
                </div>
            </div>
        `;
    }
    overlay.classList.add('active');
}

// === GAME: LEVELS ===
function renderLevels() {
    const progress = loadProgress();
    const container = document.getElementById('levelsGrid');
    container.innerHTML = '';
    
    levelsData.forEach((_, index) => {
        const levelNum = index + 1;
        const isUnlocked = levelNum <= progress.unlockedLevels;
        const stars = progress.levelStars[levelNum] || 0;
        
        const card = document.createElement('div');
        card.className = `level-card ${isUnlocked ? '' : 'locked'}`;
        if (isUnlocked) {
            card.onclick = () => startLevel(index);
        }
        
        card.innerHTML = `
            ${!isUnlocked ? '<div class="level-lock">ğŸ”’</div>' : ''}
            <div class="level-number">${levelNum}</div>
            <div class="level-label">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${levelNum}</div>
            ${stars > 0 ? `<div class="level-stars">${'â­'.repeat(stars)}</div>` : ''}
        `;
        
        container.appendChild(card);
    });
}

function startLevel(levelIndex) {
    gameState.currentLevel = levelIndex;
    gameState.currentQuestion = 0;
    gameState.points = 0;
    gameState.startTime = Date.now();
    
    document.getElementById('hudLevel').textContent = levelIndex + 1;
    document.getElementById('hudPoints').textContent = '0';
    
    navigateTo('gameScreen');
    document.getElementById('gameHud').classList.add('active');
    
    loadQuestion();
    startTimer();
}

// === GAME: TIMER ===
let timerInterval;
function startTimer() {
    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
        const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
        const mins = Math.floor(elapsed / 60).toString().padStart(2, '0');
        const secs = (elapsed % 60).toString().padStart(2, '0');
        document.getElementById('hudTimer').textContent = `${mins}:${secs}`;
    }, 1000);
}

// === GAME: QUESTION ===
function loadQuestion() {
    const level = levelsData[gameState.currentLevel];
    const q = level[gameState.currentQuestion];
    
    gameState.isChecking = false;
    gameState.selectedLetters = [];
    gameState.hintedPositions = [];
    gameState.currentAnswer = q.answer;
    
    document.getElementById('hudQuestion').textContent = `${gameState.currentQuestion + 1}/10`;
    document.getElementById('clueText').textContent = q.clue;
    
    const lettersOnly = q.answer.replace(/\s/g, '');
    const all = [...lettersOnly.split(''), ...q.extra];
    gameState.availableLetters = shuffle(all).map((l, i) => ({ id: i, letter: l, used: false }));
    
    renderEmptySlots(q.answer);
    renderChoices();
}

function shuffle(arr) {
    const a = [...arr];
    for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
}

function renderEmptySlots(answer) {
    const container = document.getElementById('answerSlots');
    container.innerHTML = '';
    container.classList.remove('correct', 'wrong');
    
    const words = answer.split(' ');
    
    if (words.length > 1) {
        container.style.flexDirection = 'column';
        container.style.gap = '10px';
        
        words.forEach((word) => {
            const row = document.createElement('div');
            row.style.display = 'flex';
            row.style.gap = '6px';
            row.style.justifyContent = 'center';
            row.style.flexWrap = 'nowrap';
            
            for (let i = 0; i < word.length; i++) {
                const slot = document.createElement('div');
                slot.className = 'empty-slot';
                row.appendChild(slot);
            }
            container.appendChild(row);
        });
    } else {
        container.style.flexDirection = 'row';
        container.style.gap = '6px';
        
        for (let i = 0; i < answer.length; i++) {
            const slot = document.createElement('div');
            slot.className = 'empty-slot';
            container.appendChild(slot);
        }
    }
}

function renderChoices() {
    const container = document.getElementById('letterChoices');
    container.innerHTML = '';
    gameState.availableLetters.forEach(item => {
        const btn = document.createElement('button');
        btn.className = 'letter-btn';
        btn.textContent = item.letter;
        btn.disabled = item.used;
        btn.onclick = () => selectLetter(item.id);
        container.appendChild(btn);
    });
}

function selectLetter(id) {
    if (gameState.isChecking) return;
    
    const item = gameState.availableLetters.find(l => l.id === id);
    if (!item || item.used) return;
    
    item.used = true;
    gameState.selectedLetters.push(id);
    
    updateAnswerSlots();
    renderChoices();
}

function updateAnswerSlots() {
    const slots = document.querySelectorAll('.empty-slot');
    const answerNoSpaces = gameState.currentAnswer.replace(/\s/g, '');
    
    slots.forEach((slot, i) => {
        slot.classList.remove('filled');
        slot.textContent = '';
        slot.onclick = null;
        
        if (gameState.hintedPositions.includes(i)) {
            slot.textContent = answerNoSpaces[i];
            slot.classList.add('hint');
        }
    });
    
    gameState.selectedLetters.forEach((id, index) => {
        let availableSlots = Array.from(slots).filter((s, i) => !gameState.hintedPositions.includes(i));
        if (availableSlots[index]) {
            const item = gameState.availableLetters.find(l => l.id === id);
            availableSlots[index].textContent = item.letter;
            availableSlots[index].classList.add('filled');
            availableSlots[index].onclick = () => removeLetter(index);
        }
    });
}

function removeLetter(index) {
    if (gameState.isChecking) return;
    
    const id = gameState.selectedLetters[index];
    const item = gameState.availableLetters.find(l => l.id === id);
    if (!item) return;
    
    item.used = false;
    gameState.selectedLetters.splice(index, 1);
    
    updateAnswerSlots();
    renderChoices();
}

function resetLetters() {
    if (gameState.isChecking) return;
    
    gameState.selectedLetters = [];
    gameState.availableLetters.forEach(l => l.used = false);
    updateAnswerSlots();
    renderChoices();
}

function useHint() {
    if (gameState.isChecking) return;
    
    if (gameState.points <= 0) {
        alert('ØªØ­ØªØ§Ø¬ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ 5 Ù†Ù‚Ø§Ø· Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯Ø©!');
        return;
    }
    
    const answerNoSpaces = gameState.currentAnswer.replace(/\s/g, '');
    const slots = Array.from(document.querySelectorAll('.empty-slot'));
    const unhinted = [];
    
    slots.forEach((slot, i) => {
        if (!gameState.hintedPositions.includes(i)) {
            unhinted.push(i);
        }
    });
    
    if (unhinted.length === 0) return;
    
    const pos = unhinted[0];
    gameState.hintedPositions.push(pos);
    gameState.points -= 5;
    
    document.getElementById('hudPoints').textContent = gameState.points;
    updateAnswerSlots();
    playSound('hint');
}

function skipQuestion() {
    if (gameState.isChecking) return;
    
    gameState.points -= 10;
    document.getElementById('hudPoints').textContent = gameState.points;
    playSound('skip');
    nextQuestion();
}

function checkAnswer() {
    if (gameState.isChecking) return;
    
    let userAnswer = '';
    const slots = document.querySelectorAll('.empty-slot');
    slots.forEach(slot => userAnswer += slot.textContent);
    
    const answerSlots = document.getElementById('answerSlots');
    const correctAnswer = gameState.currentAnswer.replace(/\s/g, '');
    
    if (userAnswer.toUpperCase() === correctAnswer.toUpperCase()) {
        gameState.isChecking = true;
        answerSlots.classList.add('correct');
        gameState.points += 20;
        document.getElementById('hudPoints').textContent = gameState.points;
        
        playSound('success');
        
        setTimeout(() => showFeedback(true), 800);
        
    } else if (userAnswer.length === 0) {
        answerSlots.style.borderColor = 'var(--accent)';
        setTimeout(() => answerSlots.style.borderColor = '', 600);
        
    } else {
        gameState.isChecking = true;
        answerSlots.classList.add('wrong');
        playSound('error');
        
        setTimeout(() => {
            answerSlots.classList.remove('wrong');
            resetLetters();
            gameState.isChecking = false;
        }, 800);
    }
}

function showFeedback(success) {
    const messages = ['Ø±Ø§Ø¦Ø¹ Ø¬Ø¯Ø§Ù‹! ğŸŒŸ', 'Ù…Ù…ØªØ§Ø²! ÙˆØ§ØµÙ„! ğŸš€', 'Ø£Ø­Ø³Ù†Øª! â­', 'Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ’ª'];
    
    const overlay = document.getElementById('feedback');
    overlay.innerHTML = `
        <div class="feedback-card">
            <div class="feedback-icon">âœ…</div>
            <div class="feedback-title success">Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!</div>
            <div class="feedback-msg">${messages[Math.floor(Math.random() * messages.length)]}</div>
            <div class="feedback-points">+20 Ù†Ù‚Ø·Ø© ğŸ…</div>
            <button class="btn btn-primary" onclick="nextQuestion()">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
        </div>
    `;
    overlay.classList.add('active');
}

function nextQuestion() {
    document.getElementById('feedback').classList.remove('active');
    
    gameState.currentQuestion++;
    
    if (gameState.currentQuestion >= 10) {
        completeLevel();
    } else {
        loadQuestion();
    }
}

function completeLevel() {
    clearInterval(timerInterval);
    
    const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
    const mins = Math.floor(elapsed / 60);
    const secs = elapsed % 60;
    
    const stars = gameState.points >= 180 ? 3 : gameState.points >= 120 ? 2 : 1;
    
    const progress = loadProgress();
    progress.levelStars[gameState.currentLevel + 1] = Math.max(stars, progress.levelStars[gameState.currentLevel + 1] || 0);
    progress.unlockedLevels = Math.max(progress.unlockedLevels, gameState.currentLevel + 2);
    saveProgress(progress);
    
    const leaderboard = loadLeaderboard();
    leaderboard.push({
        name: gameState.playerName,
        level: gameState.currentLevel + 1,
        points: gameState.points,
        time: elapsed,
        date: Date.now()
    });
    leaderboard.sort((a, b) => b.points - a.points || a.time - b.time);
    saveLeaderboard(leaderboard.slice(0, 50));
    
    const overlay = document.getElementById('feedback');
    overlay.innerHTML = `
        <div class="feedback-card level-complete">
            <div class="feedback-icon">ğŸ†</div>
            <div class="level-complete-title">Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${gameState.currentLevel + 1}!</div>
            <div class="level-stats">
                <div class="stat-row">
                    <span class="stat-label">Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</span>
                    <span class="stat-value">${gameState.points}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚</span>
                    <span class="stat-value">${mins}:${secs.toString().padStart(2,'0')}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</span>
                    <span class="stat-value">${'â­'.repeat(stars)}</span>
                </div>
            </div>
            <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
                <button class="btn btn-primary" onclick="backToLevels()">Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø¢Ø®Ø±</button>
                <button class="btn btn-ghost" onclick="showLeaderboard()">ğŸ† Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</button>
            </div>
        </div>
    `;
    overlay.classList.add('active');
}

function backToLevels() {
    document.getElementById('feedback').classList.remove('active');
    navigateTo('levelsScreen');
}

function showLeaderboard() {
    const leaderboard = loadLeaderboard();
    const list = document.getElementById('leaderboardList');
    list.innerHTML = '';
    
    if (leaderboard.length === 0) {
        list.innerHTML = '<div style="text-align:center;padding:40px;color:var(--gray);">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ø¨Ø¹Ø¯</div>';
    } else {
        leaderboard.slice(0, 10).forEach((entry, i) => {
            const mins = Math.floor(entry.time / 60);
            const secs = entry.time % 60;
            
            const row = document.createElement('div');
            row.className = 'leaderboard-row';
            row.innerHTML = `
                <div class="leaderboard-rank">${i + 1}</div>
                <div class="leaderboard-name">${entry.name}</div>
                <div class="leaderboard-score">${entry.points}</div>
                <div class="leaderboard-time">${mins}:${secs.toString().padStart(2,'0')}</div>
            `;
            list.appendChild(row);
        });
    }
    
    navigateTo('leaderboardScreen');
}

// === SOUNDS ===
let audioCtx = null;

function getAudioCtx() {
    if (!audioCtx) {
        try { audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
        catch(e) {}
    }
    return audioCtx;
}

function playSound(type) {
    const ctx = getAudioCtx();
    if (!ctx) return;
    
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain);
    gain.connect(ctx.destination);
    
    if (type === 'success') {
        osc.frequency.setValueAtTime(523, ctx.currentTime);
        osc.frequency.setValueAtTime(659, ctx.currentTime + 0.1);
        osc.frequency.setValueAtTime(784, ctx.currentTime + 0.2);
        gain.gain.setValueAtTime(0.3, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.5);
    } else if (type === 'error') {
        osc.frequency.setValueAtTime(200, ctx.currentTime);
        osc.frequency.setValueAtTime(150, ctx.currentTime + 0.2);
        gain.gain.setValueAtTime(0.3, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.4);
    } else if (type === 'hint' || type === 'skip') {
        osc.frequency.setValueAtTime(400, ctx.currentTime);
        gain.gain.setValueAtTime(0.2, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.2);
    }
}
</script>
</body>
</html>
